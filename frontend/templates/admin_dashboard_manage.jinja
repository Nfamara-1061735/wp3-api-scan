{% extends "base.jinja" %}
{% block title %} Admin - Beheren {% endblock %}
{% block head %}
    <link rel="stylesheet" href="{{ url_for('.static', filename='css/admin_dashboard_manage.css') }}">
{% endblock %}

{% block content %}
    <div class="px-5 pt-5">
        <h1 class="">Dashboard - Beheren</h1>
        <hr class="pb-3">
        <div id="alertContainer" class="alert alert-danger d-none">
        </div>
    </div>

    <!-- Tab navigation -->
    <ul class="nav nav-tabs px-5" id="adminTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if current_tab == 'peer-experts' %}active{% endif %}" id="peer-experts-tab"
               data-bs-toggle="tab" href="#peerExperts" role="tab"
               aria-controls="Ervaringsdeskundigen" aria-selected="true">Ervaringsdeskundigen
                <span id="rated-card-count" class="ms-2 badge text-bg-primary"></span>
            </a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if current_tab == 'researches' %}active{% endif %}" id="researches-tab"
               data-bs-toggle="tab" href="#researches" role="tab"
               aria-controls="Onderzoeken" aria-selected="false">Onderzoeken
                <span id="open-card-count" class="ms-2 badge text-bg-primary"></span>
            </a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if current_tab == 'admins' %}active{% endif %}" id="admins-tab" data-bs-toggle="tab"
               href="#admins" role="tab"
               aria-controls="Beheerders" aria-selected="false">Beheerders
                <span id="registered-card-count" class="ms-2 badge text-bg-primary"></span>
            </a>
        </li>
        <li class="mx-auto"></li>
        <li class="nav-item">
            <a class="btn btn-outline-secondary text-primary-emphasis"
               href="{{ url_for('frontend.dashboard') }}">Keuren</a>
        </li>
    </ul>

    <!-- Tab content -->
    <div class="tab-content mx-5" id="dashboardTabs">

        <!-- Peer Experts Tab -->
        <div class="tab-pane fade {% if current_tab == 'peer-experts' %}show active{% endif %}" id="peerExperts"
             role="tabpanel" aria-labelledby="peer-experts-tab">
            <div class="py-4">
                <div class="form-check form-switch mb-3">
                    <input class="form-check-input" type="checkbox" role="switch" id="peerShowClosed">
                    <label class="form-check-label" for="peerShowClosed">Toon gesloten ervaringsdeskundigen</label>
                </div>
                <table id="peerTable" class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th data-sort="peer_expert_id">#</th>
                            <th data-sort="first_name">Voornaam</th>
                            <th data-sort="last_name">Achternaam</th>
                            <th data-sort="postal_code">Post Code</th>
                            <th data-sort="gender">Geslacht</th>
                            <th data-sort="birth_date">Geboorte Datum</th>
                            <th class="col-1">Admin</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>

                <!-- Pagination for Peer Experts -->
                <div class="row gap-3">
                    <button id="firstPage" class="col-1 btn btn-primary">
                        <i class="me-2 bi bi-chevron-double-left"></i> Eerste
                    </button>
                    <button id="previousPage" class="col-1 btn btn-primary">
                        <i class="me-2 bi bi-chevron-left"></i> Vorige
                    </button>
                    <div class="col text-center">
                        <label for="currentPage" class="me-2">Huidige pagina: </label>
                        <input type="number" id="currentPage" class="col-1 text-center" value="1" min="1"/>
                    </div>
                    <button id="nextPage" class="col-1 btn btn-primary">
                        Volgende <i class="ms-2 bi bi-chevron-right"></i>
                    </button>
                    <button id="lastPage" class="col-1 btn btn-primary">
                        Laatste <i class="ms-2 bi bi-chevron-double-right"></i>
                    </button>
                </div>
            </div>
        </div>


        <!-- Researches Tab -->
        <div class="tab-pane fade {% if current_tab == 'researches' %}show active{% endif %}" id="researches"
             role="tabpanel" aria-labelledby="researches-tab">
            <!--legenda for research status-->
             <div class="mt-3">
                <div class="mb-2">
                    <span class="badge bg-warning rounded-circle" style="width: 15px; height: 15px; display: inline-block;"></span>
                    = Nieuw
                </div>
                <div class="mb-2">
                    <span class="badge bg-success rounded-circle" style="width: 15px; height: 15px; display: inline-block;"></span>
                    = Goedgekeurd
                </div>
                <div class="mb-2">
                    <span class="badge bg-danger rounded-circle" style="width: 15px; height: 15px; display: inline-block;"></span>
                    = Afgekeurd
                </div>
                <div>
                    <span class="badge bg-secondary rounded-circle" style="width: 15px; height: 15px; display: inline-block;"></span>
                    = Afgesloten
                </div>
            </div>

            <div class="py-4">
                <table id="researchTable" class="table table-striped table-hover" aria-describedby="researchTableDescription">
                    <caption id="researchTableDescription">Lijst van alle onderzoeken en hun status</caption>
                    <thead>
                        <tr>
                            <th scope="col" data-sort="status_id">Status</th>
                            <th scope="col" data-sort="title">Titel</th>
                            <th scope="col" data-sort="description">Beschrijving</th>
                            <th scope="col" data-sort="start_date">Startdatum</th>
                            <th scope="col" data-sort="end_date">Einddatum</th>
                            <th scope="col" data-sort="location">Locatie</th>
                            <th scope="col">Acties</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>

                <!-- Pagination for Researches -->
                <div class="row gap-3">

                    <button id="firstResearchPage" class="col-auto btn btn-primary d-flex align-items-center justify-content-center gap-2">
                        <i class="bi bi-chevron-double-left"></i>
                        Eerste
                    </button>
                    <button id="previousResearchPage" class="col-auto btn btn-primary d-flex align-items-center justify-content-center gap-2">
                        <i class="bi bi-chevron-left"></i>
                        Vorige
                    </button>
                    <div class="col text-center d-flex align-items-center justify-content-center">
                        <label for="currentResearchPage" class="me-2 mb-0">Huidige pagina: </label>
                        <input type="number" id="currentResearchPage" class="text-center" value="1" min="1" style="width: 60px;" />
                    </div>
                    <button id="nextResearchPage" class="col-auto btn btn-primary d-flex align-items-center justify-content-center gap-2">
                        Volgende
                        <i class="bi bi-chevron-right"></i>
                    </button>
                    <button id="lastResearchPage" class="col-auto btn btn-primary d-flex align-items-center justify-content-center gap-2">
                        Laatste
                        <i class="bi bi-chevron-double-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Admins Tab (Empty for now) -->
        <div class="tab-pane fade {% if current_tab == 'admins' %}show active{% endif %}" id="admins"
             role="tabpanel" aria-labelledby="admins-tab">
            <div class="py-4">
                <!-- Content for admins tab could go here -->
                <p>Beheerders beheren (optioneel)</p>
            </div>
        </div>

    </div>

    <!-- Modal for Peer Expert Details -->
    <div class="modal fade" id="peerDetailsModal" tabindex="-1" aria-labelledby="peerDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="peerDetailsModalLabel">Ervaringsdeskundige Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Sluiten"></button>
                </div>
                <div id="modalBody" class="modal-body">
                    <div id="modalAlertContainer" class="alert alert-danger d-none">
                    </div>
                    <form class="row g-3" id="peerDetailsForm" method="dialog">
                        <input type="hidden" id="peerExpertId">

                        <!-- User Details -->
                        <div class="col-md-6">
                            <label for="firstName" class="form-label">Voornaam</label>
                            <input type="text" class="form-control" id="firstName">
                        </div>
                        <div class="col-md-6">
                            <label for="lastName" class="form-label">Achternaam</label>
                            <input type="text" class="form-control" id="lastName">
                        </div>
                        <div class="col-12">
                            <label for="gender" class="form-label">Geslacht</label>
                            <input class="form-control" id="gender" list=genders>
                            <datalist id="genders">
                                <option>Man</option>
                                <option>Vrouw</option>
                                <option>Overig</option>
                            </datalist>
                        </div>
                        <div class="col-12">
                            <label for="birthDate" class="form-label">Geboortedatum</label>
                            <input type="date" class="form-control" id="birthDate">
                        </div>

                        <!-- Additional fields (email, phone, etc.) -->
                        <div class="col-12">
                            <label for="email" class="form-label">E-mailadres</label>
                            <input type="email" class="form-control" id="email">
                        </div>
                        <div class="col-12">
                            <label for="password" class="form-label">Wachtwoord</label>
                            <input type="password" class="form-control" id="password" placeholder="Nieuw password">
                        </div>
                        <div class="col-12">
                            <label for="passwordVerify">Wachtwoord herhalen</label>
                            <input type="password" class="form-control" id="passwordVerify" name="passwordVerify"
                                   placeholder="Wachtwoord herhalen">
                            <div class="invalid-feedback" id="passwordMismatchFeedback">
                                Passwords do not match.
                            </div>
                        </div>
                        <div class="col-6">
                            <label for="phoneNumber" class="form-label">Telefoonnummer</label>
                            <input type="text" class="form-control" id="phoneNumber">
                        </div>
                        <div class="col-6">
                            <label for="postalCode" class="form-label">Postcode</label>
                            <input type="text" class="form-control" id="postalCode">
                        </div>

                        <!-- Disabilities Accordion -->
                        <div class="accordion" id="disabilitiesAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingDisabilities">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#disabilitiesCollapse" aria-expanded="false"
                                            aria-controls="disabilitiesCollapse">
                                        Beperkingen
                                    </button>
                                </h2>
                                <div id="disabilitiesCollapse" class="accordion-collapse collapse"
                                     aria-labelledby="headingDisabilities" data-bs-parent="#disabilitiesAccordion">
                                    <div id="disabilities" class="accordion-body">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Information -->
                        <div class="col-12">
                            <label for="toolsUsed" class="form-label">Gebruikte hulpmiddelen</label>
                            <input type="text" class="form-control" id="toolsUsed">
                        </div>
                        <div class="col-12">
                            <label for="shortBio" class="form-label">Kort voorstellen</label>
                            <textarea class="form-control" id="shortBio"></textarea>
                        </div>
                        <div class="col-12">
                            <label for="specialNotes" class="form-label">Bijzonderheden</label>
                            <textarea class="form-control" id="specialNotes"></textarea>
                        </div>

                        <!-- Supervisor / Guardian Information -->
                        <div class="col-12">
                            <input type="checkbox" class="form-check-input" id="hasSupervisor">
                            <label class="form-check-label" for="hasSupervisor">Heeft toezichthouder</label>
                        </div>
                        <div class="accordion" id="supervisorAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingSupervisor">
                                    <button id="supervisorAccordionButton" class="accordion-button collapsed"
                                            type="button" data-bs-toggle="collapse"
                                            data-bs-target="#supervisorGroupCollapse" aria-expanded="false"
                                            aria-controls="supervisorGroupCollapse">
                                        Toezichthouder / Voogd
                                    </button>
                                </h2>
                                <div id="supervisorGroupCollapse" class="accordion-collapse collapse"
                                     aria-labelledby="headingSupervisor" data-bs-parent="#supervisorAccordion">
                                    <div class="accordion-body">
                                        <div>
                                            <label for="supervisorOrGuardianName" class="form-label">Naam voogd of
                                                toezichthouder</label>
                                            <input type="text" class="form-control" id="supervisorOrGuardianName">
                                        </div>
                                        <div>
                                            <label for="supervisorOrGuardianEmail" class="form-label">E-mailadres voogd
                                                of toezichthouder</label>
                                            <input type="email" class="form-control" id="supervisorOrGuardianEmail">
                                        </div>
                                        <div>
                                            <label for="supervisorOrGuardianPhone" class="form-label">Telefoonnummer
                                                voogd of toezichthouder</label>
                                            <input type="text" class="form-control" id="supervisorOrGuardianPhone">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Status -->
                        <div id="peerStatuses" class="col-12">
                            <label for="peerStatus" class="form-label">Status</label>
                            <select class="form-control" id="peerStatus">
                            </select>
                        </div>

                        <!-- Availability & Contact Preferences -->
                        <div id="contactPreferences" class="col-12">
                            <label for="contactPreference" class="form-label">Voorkeur benadering</label>
                            <select class="form-control" id="contactPreference">
                            </select>
                        </div>
                        <div id="researchType" class="col-12">
                            <label for="researchType" class="form-label">Type onderzoek</label>
                        </div>
                        <div class="col-12">
                            <label for="availabilityNotes" class="form-label">Bijzonderheden beschikbaarheid</label>
                            <textarea class="form-control" id="availabilityNotes"></textarea>
                        </div>
                        <div class="col-12">
                            <input type="checkbox" class="form-check-input" id="acceptedTerms">
                            <label class="form-check-label" for="acceptedTerms">Akkoord met voorwaarden</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" id="deletePeer">Verwijderen</button>
                    <div class="mx-auto"></div>
                    <button type="submit" form="peerDetailsForm" class="btn btn-primary" id="savePeer">Wijzigingen
                        Opslaan
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Sluiten</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Research Details -->
    <div class="modal fade" id="researchDetailsModal" tabindex="-1" aria-labelledby="researchDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="researchDetailsModalLabel">Onderzoek Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Sluiten"></button>
                </div>
                <div class="modal-body">
                    <form id="researchDetailsForm">
                        <input type="hidden" id="researchId">

                        <div class="mb-3">
                            <label for="researchTitle" class="form-label">Titel</label>
                            <input type="text" class="form-control" id="researchTitle">
                        </div>
                        <div class="mb-3">
                            <label for="researchLocation" class="form-label">Locatie</label>
                            <input type="text" class="form-control" id="researchLocation">
                        </div>
                        <div class="mb-3">
                            <label for="researchDescription" class="form-label">Beschrijving</label>
                            <textarea class="form-control" id="researchDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="researchStartDate" class="form-label">Startdatum</label>
                            <input type="date" class="form-control" id="researchStartDate">
                        </div>
                        <div class="mb-3">
                            <label for="researchEndDate" class="form-label">Einddatum</label>
                            <input type="date" class="form-control" id="researchEndDate">
                        </div>

                        <!-- Additional fields (beschikbaarheid, beloning, limitations, etc.) -->
                        <div class="mb-3">
                            <label for="researchIsAvailable" class="form-label">Beschikbaar</label>
                            <input type="checkbox" class="form-check-input" id="researchIsAvailable">
                        </div>
                        <div class="mb-3">
                            <label for="researchHasReward" class="form-label">Beloning</label>
                            <input type="checkbox" class="form-check-input" id="researchHasReward">
                        </div>
                        <div class="mb-3" id="researchRewardContainer">
                            <label for="researchReward" class="form-label">Beloningsomschrijving</label>
                            <input type="text" class="form-control" id="researchReward">
                        </div>
                        <div class="mb-3">
                            <label for="researchTargetMinAge" class="form-label">Minimale Leeftijd</label>
                            <input type="number" class="form-control" id="researchTargetMinAge">
                        </div>
                        <div class="mb-3">
                            <label for="researchTargetMaxAge" class="form-label">Maximale Leeftijd</label>
                            <input type="number" class="form-control" id="researchTargetMaxAge">
                        </div>
                        <div class="mb-3">
                            <label for="researchStatusId" class="form-label">Status</label>
                            <select class="form-select" id="researchStatusId" required>
                                <option value="1">Nieuw</option>
                                <option value="2">Goedgekeurd</option>
                                <option value="3">Afgekeurd</option>
                                <option value="4">Afgesloten</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="researchTypeId" class="form-label">Type ID</label>
                            <input type="number" class="form-control" id="researchTypeId">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Beperkingen</label>
                            <div id="selectedLimitationsList" class="mb-2">
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm" id="openLimitationsModalBtn">
                                Kies Beperkingen
                            </button>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger" id="deleteResearchBtn">Verwijderen</button>
                            <div class="mx-auto"></div>
                            <button type="submit" class="btn btn-primary">Wijzigingen Opslaan</button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Sluiten</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Selecting Limitations -->
    <div class="modal fade" id="limitationsModal" tabindex="-1" aria-labelledby="limitationsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-md modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="limitationsModalLabel">Kies Beperkingen</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Sluiten"></button>
                </div>
                <div class="modal-body">
                    <form id="limitationsForm">
                        <div id="limitationsCheckboxes">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="saveLimitationsBtn">Beperkingen Opslaan</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuleren</button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
{% block scripts %}
    <script src="{{ url_for('.static', filename='js/admin_dashboard_manage.js') }}"></script>
{% endblock %}